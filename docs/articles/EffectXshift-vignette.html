<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Effect Modification Identification and Estimation using Data-Adaptive Stochastic Interventions • EffectXshift</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Effect Modification Identification and Estimation using Data-Adaptive Stochastic Interventions">
<meta property="og:description" content="EffectXshift">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EffectXshift</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/EffectXshift-vignette.html">Effect Modification Identification and Estimation using Data-Adaptive Stochastic Interventions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="EffectXshift-vignette_files/kePrint-0.0.1/kePrint.js"></script><link href="EffectXshift-vignette_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Effect Modification Identification and
Estimation using Data-Adaptive Stochastic Interventions</h1>
                        <h4 data-toc-skip class="author">David
McCoy</h4>
            
            <h4 data-toc-skip class="date">2024-03-22</h4>
      
      
      <div class="hidden name"><code>EffectXshift-vignette.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">EffectXshift</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: usethis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/sl3" class="external-link">sl3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">429153</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>The motivation behind the package EffectXshift is to answer the
question, “what subpopulations of individuals” have the largest
difference in impact in the even of a exposure intervention. Researchers
are often interested in understanding vulnerable subpopulations, or
individuals with certain characteristics like sex or age, that make them
more susceptible to the impact of a drug or pollutant.</p>
<p>Methods like R-learners, S-learners, T-learners, and X-learners, have
been pivotal in estimating Conditional Average Treatment Effects (CATE)
across diverse settings. While S-learners apply a single model to the
entire data, incorporating treatment as a feature, T-learners use
separate models for treated and control groups to capture distinct
patterns. X-learners, designed for settings with imbalanced treatment
groups, first estimate treatment effects for both groups separately and
then use the information from one group to refine the estimates for the
other. Despite their effectiveness, these methods often act as black
boxes, offering limited insights into which specific subpopulations are
most affected by a treatment or exposure. Our work with EffectXshift
addresses this gap by providing an interpretable framework that not only
estimates the impact of interventions but also identifies subpopulations
with the maximal effect difference. This approach enhances our
understanding of treatment effects, facilitating targeted interventions
and personalized treatment strategies.</p>
</div>
<div class="section level2">
<h2 id="target-parameter">Target Parameter<a class="anchor" aria-label="anchor" href="#target-parameter"></a>
</h2>
<p>EffectXshift uses data-adaptive machine learning methods to identify
the exposure-covariate combination that has the maximum difference in
the impact of intervention.</p>
<p>Given a set of exposures <span class="math inline">\(\boldsymbol{A}\)</span>, a covariate space <span class="math inline">\(W\)</span>, and a particular outcome <span class="math inline">\(Y\)</span>, our goal is to identify the exposure
<span class="math inline">\(A_i \in \boldsymbol{A}\)</span> and region
<span class="math inline">\(V \subseteq W\)</span> that demonstrate the
maximal difference in the expected outcome with an intervention applied,
compared across <span class="math inline">\(V\)</span> and its
complementary region <span class="math inline">\(V^c\)</span>. Our
target parameter looks like:</p>
<p>$$</p>
<p><span class="math display">\[\begin{align*}
&amp;\underset{A_i \in \boldsymbol{A}, \, V \subseteq W}{\text{arg max}}
\\
&amp;\quad E\left[\, E\left[Y \,|\, A_i + \delta_i, \, W_j \in V, \,
W_{\setminus j}\right] \right. \\
&amp;\quad \left. - E\left[Y \,|\,A_i + \delta_i, \, W_j \in V^c, \,
W_{\setminus j}\right] \, \right].
\end{align*}\]</span></p>
<p>$$ Here, <span class="math inline">\(\delta_i\)</span> denotes the
intervention effect on exposure <span class="math inline">\(A_i\)</span>, and <span class="math inline">\(V^c\)</span> represents the complementary set of
<span class="math inline">\(V\)</span> within <span class="math inline">\(W\)</span>.</p>
<p>To elucidate the EffectXshift algorithm, we commence by fitting an
outcome model utilizing the Super Learner ensemble methodology. This
model is tasked with predicting the outcome variable, <span class="math inline">\(Y\)</span>, based on a set of exposures, <span class="math inline">\(\boldsymbol{A}\)</span>, and covariates, <span class="math inline">\(\boldsymbol{W}\)</span>. The Super Learner
algorithm, a machine learning ensemble, optimally combines predictions
from a pre-specified library of candidate models to minimize prediction
error, thereby offering a flexible and robust approach to outcome
modeling.</p>
<p>Subsequently, for each exposure <span class="math inline">\(A_i\)</span> within the vector of exposures <span class="math inline">\(\boldsymbol{A}\)</span>, we apply a shift, denoted
by <span class="math inline">\(\delta_i\)</span>, and predict the
expected outcome under this perturbation, yielding <span class="math inline">\(E[Y | A_i + \delta_i, \boldsymbol{W}]\)</span>.
This process is repeated for the baseline scenario without the shift to
compute <span class="math inline">\(E[Y | \boldsymbol{A},
\boldsymbol{W}]\)</span>. The difference between these two expected
outcomes, <span class="math inline">\(E[Y | A_i + \delta_i,
\boldsymbol{W}] - E[Y | \boldsymbol{A}, \boldsymbol{W}]\)</span>,
constitutes our individual treatment effect (ITE) vectors, capturing the
expected change in outcome attributable to the intervention <span class="math inline">\(\delta_i\)</span> on exposure <span class="math inline">\(A_i\)</span>.</p>
<p>To identify subpopulations with maximally differential responses to
the intervention, we employ a custom decision tree algorithm that
partitions the covariate space <span class="math inline">\(\boldsymbol{W}\)</span> in a manner that maximizes
the average difference in population intervention effects between the
resulting regions. This tree-based partitioning is performed
recursively, with splits chosen to greedily maximize the difference in
mean ITE between subgroups defined by the covariates within <span class="math inline">\(\boldsymbol{W}\)</span>. This approach aims to
approximate the oracle target parameter: the region in the covariate
space where the intervention exhibits the maximal differential
effect.</p>
<p>The final output of the EffectXshift algorithm is a set of rules
defining covariate-based subpopulations alongside estimates of the
population intervention effect within these subpopulations. This not
only provides insights into the heterogeneity of treatment effects
across different segments of the population but also guides the
identification of individuals who stand to benefit most from targeted
interventions, thus embodying a significant stride towards personalized
treatment strategies.</p>
</div>
<div class="section level2">
<h2 id="doubly-robust-estimation">Doubly Robust Estimation<a class="anchor" aria-label="anchor" href="#doubly-robust-estimation"></a>
</h2>
<p>The above g-computation approach to estimation the population
intervention effect which is then regressed onto covariates using our
custom decision tree to find the maximal subpopulation intervention
effect is the data-adaptive discovery portion of the method. What comes
out is an exposure-covariate region combination for each fold. We then
estimate stochastic interventions, shifting the exposure in subregions
of the covariate space found and applying targeted learning to debias
our initial estimates. In order to get proper inference for the
subpopulation intervention effect in the covariate regions we use
targeted learning. Briefly, we fit a propensity score estimator to
estimate the likelihood of exposure levels given covariates under the
observed exposure level and intervened level, the ratio of these
likelihoods consitutes the clever covariate for the influence curve of a
stochastic intervention. We use this clever covariate to update our
initial estimates of the expected outcome under shift which initially is
done using Super Learner. This targeting step debiases our estimates and
we are able to get confidence intervals.</p>
</div>
<div class="section level2">
<h2 id="sample-splitting">Sample Splitting<a class="anchor" aria-label="anchor" href="#sample-splitting"></a>
</h2>
<p>Because we don’t know which exposure-covariate regions to estimate
our effect modification parameter a priori, we need to split our data
and in the training fold find the exposure-covariate region, using the
above g-computation framework, and in an estimation sample, efficiently
estimate the subpopulation intervention effect parameter for the
identified exposure in the covariate regions so that we can get valid
confidence intervals for these data-adaptively identified interactions.
As discussed above, is done using targeted learning. This sample
splitting is through a cross-validation framework, ensuring the
identification of our oracle parameter, the maximizing
exposure-covariate region, is independent of the estimation, given we
don’t know the maximum effect modifier beforehand.</p>
</div>
<div class="section level2">
<h2 id="targeted-learning">Targeted Learning<a class="anchor" aria-label="anchor" href="#targeted-learning"></a>
</h2>
<p>We use targeted minimum loss based estimation (TMLE) to debias our
initial outcome estimates given a shift in exposure such that the
resulting estimator is asymptotically unbiased and has the smallest
variance. This procedure involves constructing a least favorable
submodel which uses a ratio of conditional exposure densities under
shift and now shift as a covariate to debias the initial estimates. More
details of targeted learning for stochastic shifts are here <span class="citation">Dı́az and van der Laan (2012)</span></p>
</div>
<div class="section level2">
<h2 id="data-adaptive-delta">Data Adaptive Delta<a class="anchor" aria-label="anchor" href="#data-adaptive-delta"></a>
</h2>
<p>For each exposure, the user inputs a respective delta, for example
for exposures <span class="math inline">\(M1, M2, M3\)</span> the
analyst puts in the <code>deltas</code> vector</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deltas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M1"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"M2"</span> <span class="op">=</span> <span class="fl">2.3</span>, <span class="st">"M3"</span> <span class="op">=</span> <span class="fl">1.4</span><span class="op">)</span></span></code></pre></div>
<p>Which assigns a delta shift amount to each exposure. However, because
the user doesn’t know the underlying experimentation in the data, a
delta that is too big may result in positivity violations which leads to
bias and high variance of the estimator. That is, if the user asks for a
shift in exposure density that is very unlikely given the data. To solve
this, the analyst can also choose to set
<code>adaptive_delta = TRUE</code> which then makes the shift amount a
data adaptive parameter as well. The delta will be reduced until the max
of the ratio of densities for each exposure is less than or equal to
<code>hn_trunc_thresh</code>.</p>
</div>
<div class="section level2">
<h2 id="inputs-and-outputs">Inputs and Outputs<a class="anchor" aria-label="anchor" href="#inputs-and-outputs"></a>
</h2>
<p>EffectXshift takes in covariates, exposures, an outcome, a list of
deltas to shift each exposure by, the estimator (tmle or one step)
number of folds for the CV procedure, parallelization parameters and if
the delta should be data-adaptive. Also the user defines top_n which is
the number of ranked effect modification relationships, where 1 is the
max.</p>
<p>The package then outputs K-fold specific results, the result found in
each fold, and the oracle result which is the parameter that is pooled
across all the folds. For example, we will get the fold specific
modification results for the rank 1 exposure-covariate region found to
have the highest modification. The pooled parameter is the oracle rank
1, meaning we do a pooled TMLE for all the rank 1 findings across the
folds.</p>
<p>If the same exposure-covariate reguion are used across the folds, the
pooled estimate is interpretable and has greater power compared to
k-fold. If not, the analyst must investigate the k-fold specific results
and report consistency of findings.</p>
</div>
<div class="section level2">
<h2 id="nhanes-data">NHANES Data<a class="anchor" aria-label="anchor" href="#nhanes-data"></a>
</h2>
<p>Here we will try and replicate the analysis by Gibson et. al., <a href="https://ehjournal.biomedcentral.com/articles/10.1186/s12940-019-0515-1" class="external-link uri">https://ehjournal.biomedcentral.com/articles/10.1186/s12940-019-0515-1</a></p>
<p>and Mitro et. al, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4858394/" class="external-link uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4858394/</a></p>
<p>Who used the NHANES 2001-2002 data to investigate 18 POP exposures on
telomere length.</p>
<p>In this NHANES example, we will investigate if any of the included
baseline covariates modify the impact of intervening on any of the
persistant organic pollutants.</p>
<p>Let’s first load the data and investigate the variables:</p>
</div>
<div class="section level2">
<h2 id="nhanes-data-1">NHANES Data<a class="anchor" aria-label="anchor" href="#nhanes-data-1"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"NHANES_eurocim"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">exposures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LBX074LA"</span>, <span class="co"># PCB74 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX099LA"</span>, <span class="co"># PCB99 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX118LA"</span>, <span class="co"># PCB118 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX138LA"</span>, <span class="co"># PCB138 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX153LA"</span>, <span class="co"># PCB153 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX170LA"</span>, <span class="co"># PCB170 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX180LA"</span>, <span class="co"># PCB180 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX187LA"</span>, <span class="co"># PCB187 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX194LA"</span>, <span class="co"># PCB194 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBXD03LA"</span>, <span class="co"># 1,2,3,6,7,8-hxcdd Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXD05LA"</span>, <span class="co"># 1,2,3,4,6,7,8-hpcdd Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXD07LA"</span>, <span class="co"># 1,2,3,4,6,7,8,9-ocdd Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF03LA"</span>, <span class="co"># 2,3,4,7,8-pncdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF04LA"</span>, <span class="co"># 1,2,3,4,7,8-hxcdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF05LA"</span>, <span class="co"># 1,2,3,6,7,8-hxcdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF08LA"</span>, <span class="co"># 1,2,3,4,6,7,8-hxcdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXHXCLA"</span>, <span class="co"># 3,3',4,4',5,5'-hxcb Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXPCBLA"</span><span class="op">)</span> <span class="co"># 3,3',4,4',5-pcnb Lipid Adj (pg/g)</span></span>
<span></span>
<span><span class="va">NHANES_eurocim</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">NHANES_eurocim</span><span class="op">[</span>, <span class="va">exposures</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="st">"TELOMEAN"</span></span>
<span></span>
<span><span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LBXWBCSI"</span>, <span class="co"># White blood cell count (SI)</span></span>
<span>                <span class="st">"LBXLYPCT"</span>, <span class="co"># Lymphocyte percent (%)</span></span>
<span>                <span class="st">"LBXMOPCT"</span>, <span class="co"># Monocyte percent (%)</span></span>
<span>                <span class="st">"LBXEOPCT"</span>, <span class="co"># Eosinophils percent (%)</span></span>
<span>                <span class="st">"LBXBAPCT"</span>, <span class="co"># Basophils percent (%)</span></span>
<span>                <span class="st">"LBXNEPCT"</span>, <span class="co"># Segmented neutrophils percent (%)</span></span>
<span>                <span class="st">"male"</span>, <span class="co"># Sex</span></span>
<span>                <span class="st">"age_cent"</span>, <span class="co"># Age at Screening, centered</span></span>
<span>                <span class="st">"race_cat"</span>, <span class="co"># race</span></span>
<span>                <span class="st">"bmi_cat3"</span>, <span class="co"># Body Mass Index (kg/m**2)</span></span>
<span>                <span class="st">"ln_lbxcot"</span>, <span class="co"># Cotinine (ng/mL), log-transformed</span></span>
<span>                <span class="st">"edu_cat"</span><span class="op">)</span> <span class="co"># Education Level - Adults 20+</span></span></code></pre></div>
<p>To improve consistency in the region we find to be the maximizing
region, it is best to remove an exposure of highly correlated sets, we
do that here:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the correlation matrix for the exposures</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">NHANES_eurocim</span><span class="op">[</span>, <span class="va">exposures</span><span class="op">]</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set a threshold for high correlation</span></span>
<span><span class="va">threshold</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span></span>
<span><span class="co"># Find pairs of highly correlated exposures</span></span>
<span><span class="va">highly_correlated_pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">threshold</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initiate a vector to keep track of exposures to remove</span></span>
<span><span class="va">exposures_to_remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop through the highly correlated pairs and decide which exposure to remove</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">pair</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">highly_correlated_pairs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">row</span> <span class="op">&lt;-</span> <span class="va">highly_correlated_pairs</span><span class="op">[</span><span class="va">pair</span>, <span class="st">"row"</span><span class="op">]</span></span>
<span>  <span class="va">col</span> <span class="op">&lt;-</span> <span class="va">highly_correlated_pairs</span><span class="op">[</span><span class="va">pair</span>, <span class="st">"col"</span><span class="op">]</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span><span class="op">[</span><span class="va">row</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">exposures_to_remove</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">exposures_to_remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">exposures_to_remove</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span><span class="op">[</span><span class="va">row</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Keep only uncorrelated exposures</span></span>
<span><span class="va">exposures_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">exposures</span>, <span class="va">exposures_to_remove</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-cvtreemle">Run CVtreeMLE<a class="anchor" aria-label="anchor" href="#run-cvtreemle"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deltas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"LBX074LA"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"LBX099LA"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"LBXD03LA"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="st">"LBXD05LA"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"LBXF03LA"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"LBXF04LA"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"LBXF08LA"</span> <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  <span class="st">"LBXPCBLA"</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ptm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim</span><span class="op">[</span>, <span class="va">covariates</span><span class="op">]</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim</span><span class="op">[</span>, <span class="va">exposures_to_keep</span><span class="op">]</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim</span><span class="op">$</span><span class="va">TELOMEAN</span></span>
<span></span>
<span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">23432</span></span>
<span><span class="va">NIEH_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/EffectXshift.html">EffectXshift</a></span><span class="op">(</span></span>
<span>  w <span class="op">=</span> <span class="va">w</span>,</span>
<span>  a <span class="op">=</span> <span class="va">a</span>,</span>
<span>  y <span class="op">=</span> <span class="va">y</span>,</span>
<span>  deltas <span class="op">=</span> <span class="va">deltas</span>,</span>
<span>  n_folds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel_type <span class="op">=</span> <span class="st">"multi_session"</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span>,</span>
<span>  adaptive_delta <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  top_n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  min_obs <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; [1] "Returning base case rule at depth: 1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 249.9542  Pars:  0.38578 0.61422</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 249.9542  Pars:  0.38578 0.61422</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3013.4960     Pars:  0.01173 0.98827</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3013.4960     Pars:  0.01173 0.98827</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2100.1514     Pars:  0.22464 0.77536</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2100.1514     Pars:  0.22464 0.77536</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 170.9128  Pars:  0.69333 0.30667</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 170.9128  Pars:  0.69333 0.30667</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 636.1335  Pars:  0.92099 0.07901</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 636.1335  Pars:  0.92102 0.07898</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 6916.5201     Pars:  0.06420 0.93580</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 6916.5201     Pars:  0.06420 0.93580</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2542.1744     Pars:  0.83160 0.16840</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2542.1744     Pars:  0.83160 0.16840</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 208.5135  Pars:  0.76866 0.23134</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 208.5135  Pars:  0.76866 0.23134</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 172.4584  Pars:  0.92920 0.07080</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 172.4584  Pars:  0.92920 0.07080</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1897.1991     Pars:  0.29675 0.70325</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1897.1991     Pars:  0.29675 0.70325</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">ptm</span></span>
<span><span class="co">#&gt;     user   system  elapsed </span></span>
<span><span class="co">#&gt;  289.749   36.265 4427.767</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="investigating-results">Investigating Results<a class="anchor" aria-label="anchor" href="#investigating-results"></a>
</h2>
<p>One note is that for this example we will get more variability than
normal because we only run 5 fold CV due to computational time.</p>
<p>Let’s first look at the results for each fold:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">k_fold_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">NIEH_results</span><span class="op">$</span><span class="va">`Effect Modification K-Fold Results`</span><span class="op">)</span></span>
<span></span>
<span><span class="va">k_fold_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"K-Fold Effect Modification Results"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Cambria"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
K-Fold Effect Modification Results
</caption>
<thead><tr>
<th style="text-align:left;">
Condition
</th>
<th style="text-align:right;">
Psi
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
<th style="text-align:left;">
Fold
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Delta
</th>
<th style="text-align:left;">
Covariate_region
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Fold : 1 | Rank : 1 | Exposure : LBXPCBLA | Modifier : LBXMOPCT | Level
: 1
</td>
<td style="text-align:right;">
0.3363805
</td>
<td style="text-align:right;">
0.0035258
</td>
<td style="text-align:right;">
0.0593789
</td>
<td style="text-align:right;">
0.2200
</td>
<td style="text-align:right;">
0.4528
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXMOPCT &lt;= 4.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Fold : 1 | Rank : 1 | Exposure : LBXPCBLA | Modifier : LBXMOPCT | Level
: 2
</td>
<td style="text-align:right;">
0.0955148
</td>
<td style="text-align:right;">
0.0002571
</td>
<td style="text-align:right;">
0.0160340
</td>
<td style="text-align:right;">
0.0641
</td>
<td style="text-align:right;">
0.1269
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXMOPCT &gt; 4.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Fold : 2 | Rank : 1 | Exposure : LBXF03LA | Modifier : ln_lbxcot | Level
: 1
</td>
<td style="text-align:right;">
-0.0097157
</td>
<td style="text-align:right;">
0.0001673
</td>
<td style="text-align:right;">
0.0129355
</td>
<td style="text-align:right;">
-0.0351
</td>
<td style="text-align:right;">
0.0156
</td>
<td style="text-align:right;">
0.4525977
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
191
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
ln_lbxcot &lt;= 5.6131281064
</td>
</tr>
<tr>
<td style="text-align:left;">
Fold : 2 | Rank : 1 | Exposure : LBXF03LA | Modifier : ln_lbxcot | Level
: 2
</td>
<td style="text-align:right;">
0.0517840
</td>
<td style="text-align:right;">
0.0008055
</td>
<td style="text-align:right;">
0.0283814
</td>
<td style="text-align:right;">
-0.0038
</td>
<td style="text-align:right;">
0.1074
</td>
<td style="text-align:right;">
0.0680653
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
ln_lbxcot &gt; 5.6131281064
</td>
</tr>
<tr>
<td style="text-align:left;">
Fold : 3 | Rank : 1 | Exposure : LBX099LA | Modifier : LBXNEPCT | Level
: 1
</td>
<td style="text-align:right;">
0.1028096
</td>
<td style="text-align:right;">
0.0020189
</td>
<td style="text-align:right;">
0.0449320
</td>
<td style="text-align:right;">
0.0147
</td>
<td style="text-align:right;">
0.1909
</td>
<td style="text-align:right;">
0.0221309
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXNEPCT &lt;= 45.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Fold : 3 | Rank : 1 | Exposure : LBX099LA | Modifier : LBXNEPCT | Level
: 2
</td>
<td style="text-align:right;">
0.6989927
</td>
<td style="text-align:right;">
0.0002954
</td>
<td style="text-align:right;">
0.0171873
</td>
<td style="text-align:right;">
0.6653
</td>
<td style="text-align:right;">
0.7327
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
178
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXNEPCT &gt; 45.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Fold : 4 | Rank : 1 | Exposure : LBXF08LA | Modifier : ln_lbxcot | Level
: 1
</td>
<td style="text-align:right;">
-0.0913682
</td>
<td style="text-align:right;">
0.0003323
</td>
<td style="text-align:right;">
0.0182299
</td>
<td style="text-align:right;">
-0.1271
</td>
<td style="text-align:right;">
-0.0556
</td>
<td style="text-align:right;">
0.0000005
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
189
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
ln_lbxcot &lt;= 5.6131281064
</td>
</tr>
<tr>
<td style="text-align:left;">
Fold : 4 | Rank : 1 | Exposure : LBXF08LA | Modifier : ln_lbxcot | Level
: 2
</td>
<td style="text-align:right;">
0.1969147
</td>
<td style="text-align:right;">
0.0090394
</td>
<td style="text-align:right;">
0.0950756
</td>
<td style="text-align:right;">
0.0106
</td>
<td style="text-align:right;">
0.3833
</td>
<td style="text-align:right;">
0.0383459
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
ln_lbxcot &gt; 5.6131281064
</td>
</tr>
<tr>
<td style="text-align:left;">
Fold : 5 | Rank : 1 | Exposure : LBXF04LA | Modifier : LBXMOPCT | Level
: 1
</td>
<td style="text-align:right;">
-0.0618278
</td>
<td style="text-align:right;">
0.0028011
</td>
<td style="text-align:right;">
0.0529257
</td>
<td style="text-align:right;">
-0.1656
</td>
<td style="text-align:right;">
0.0419
</td>
<td style="text-align:right;">
0.2427261
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXMOPCT &lt;= 5.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Fold : 5 | Rank : 1 | Exposure : LBXF04LA | Modifier : LBXMOPCT | Level
: 2
</td>
<td style="text-align:right;">
0.0048994
</td>
<td style="text-align:right;">
0.0003625
</td>
<td style="text-align:right;">
0.0190394
</td>
<td style="text-align:right;">
-0.0324
</td>
<td style="text-align:right;">
0.0422
</td>
<td style="text-align:right;">
0.7969249
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
178
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXMOPCT &gt; 5.4
</td>
</tr>
</tbody>
</table>
<p>Here, the condition column is the fold specific finding for the top
ranked effect modifying exposure-covariate region. For example, in fold
1 LBXF08LA is the exposure found to have the most modification in levels
of ln_lbxcot, which is log transformed values for cotinine, a measure of
smoking. Covariate_region is the threshold that was found that maximizes
the subpopulation intervention effect. This shows where ln_lbxcot was
split to define levels 1 and 2. We get subpopulation intervention
effects for a -0.5 shift in LBXF08LA in each level of ln_lbxcot.</p>
<p>Here we see that, although the exposure that is shifted varies across
folds, LBXF08LA, LBXF03LA, LBXD05LA, cotinine is always the modifier
which indicates that cotinine is the maximum modifying covariate on POP
exposure.</p>
<p>Because of the variability (due to small k fold used in this example)
of the exposure that is chosen, interpretation of the oracle parameter,
pooling our estimates across levels, is difficult to interpret but we
show the output here:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pooled_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">NIEH_results</span><span class="op">$</span><span class="va">`Effect Modification Pooled Results`</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pooled_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Pooled TMLE Results"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Cambria"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Pooled TMLE Results
</caption>
<thead><tr>
<th style="text-align:left;">
Condition
</th>
<th style="text-align:right;">
Psi
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
<th style="text-align:left;">
Fold
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Delta
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1_1
</td>
<td style="text-align:right;">
-0.0715748
</td>
<td style="text-align:right;">
0.0001415
</td>
<td style="text-align:right;">
0.0118947
</td>
<td style="text-align:right;">
-0.0949
</td>
<td style="text-align:right;">
-0.0483
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
431
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1_2
</td>
<td style="text-align:right;">
0.3357667
</td>
<td style="text-align:right;">
0.0003416
</td>
<td style="text-align:right;">
0.0184822
</td>
<td style="text-align:right;">
0.2995
</td>
<td style="text-align:right;">
0.3720
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
572
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>Of course, pooled results are only interpretable if the same
exposure-covariate region was found in the definition of level 1 and
level 2. When results are consistent, this indicates a shift in the same
exposure in the same region of the covariate space and we are able to
leverage more data in the estimation folds to get more precise
estimates.</p>
<p>In this example with fewer folds due to computational reasons, there
is incosistency, however the fact that cotinine is found as a modifier
for all the POPs is useful for researchers who are interested in knowing
the differential impact of POP exposure - that is, people who smoke may
be more impacted by POPs.</p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-diaz2012population" class="csl-entry">
Dı́az, Iván, and Mark J van der Laan. 2012. <span>“Population
Intervention Causal Effects Based on Stochastic Interventions.”</span>
<em>Biometrics</em> 68 (2): 541–49.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David McCoy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
